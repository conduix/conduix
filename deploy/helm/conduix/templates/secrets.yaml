{{- if .Values.secrets.create }}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "conduix.fullname" . }}-secrets
  labels:
    {{- include "conduix.labels" . | nindent 4 }}
type: Opaque
data:
  {{- if .Values.secrets.jwtSecret }}
  jwt-secret: {{ .Values.secrets.jwtSecret | b64enc | quote }}
  {{- else }}
  # 자동 생성된 JWT 시크릿 (프로덕션에서는 직접 설정 권장)
  jwt-secret: {{ randAlphaNum 32 | b64enc | quote }}
  {{- end }}
  {{- if .Values.controlPlane.oauth2.github.clientSecret }}
  github-client-secret: {{ .Values.controlPlane.oauth2.github.clientSecret | b64enc | quote }}
  {{- end }}
  {{- if .Values.controlPlane.oauth2.google.clientSecret }}
  google-client-secret: {{ .Values.controlPlane.oauth2.google.clientSecret | b64enc | quote }}
  {{- end }}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "conduix.fullname" . }}-redis-password
  labels:
    {{- include "conduix.labels" . | nindent 4 }}
type: Opaque
data:
  {{- if .Values.redis.auth.password }}
  redis-password: {{ .Values.redis.auth.password | b64enc | quote }}
  {{- else }}
  redis-password: {{ "" | b64enc | quote }}
  {{- end }}
{{- end }}
